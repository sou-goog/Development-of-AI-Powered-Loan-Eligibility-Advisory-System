# AI Loan System - Deployment Guide

## Overview
This guide covers deploying the AI Loan System with:
- **Frontend:** Vercel (React)
- **Backend:** Render (FastAPI + PostgreSQL)

---

## Prerequisites

1. **API Keys** (Required):
   - Groq API Key (for voice LLM): https://console.groq.com/keys
   - Deepgram API Key (for voice STT/TTS): https://console.deepgram.com/
   
2. **Accounts**:
   - GitHub account (to connect repositories)
   - Render account: https://render.com/
   - Vercel account: https://vercel.com/

---

## Step 1: Deploy Backend on Render

### 1.1 Create New Service
1. Go to https://dashboard.render.com/
2. Click **"New +"** â†’ **"Blueprint"**
3. Connect your GitHub repository: `sou-goog/Development-of-AI-Powered-Loan-Eligibility-Advisory-System`
4. Select the `main` branch
5. Render will detect `render.yaml` and create:
   - Web Service: `ai-loan-backend`
   - PostgreSQL Database: `ai-loan-db`

### 1.2 Set Environment Variables
In the Render dashboard for `ai-loan-backend`:
1. Go to **Environment** tab
2. Add the following variables:
   ```
   GROQ_API_KEY=<your-groq-api-key>
   DEEPGRAM_API_KEY=<your-deepgram-api-key>
   ```
3. The following are auto-generated by Render:
   - `DATABASE_URL` (from PostgreSQL database)
   - `SECRET_KEY` (random value)

### 1.3 Deploy
1. Click **"Manual Deploy"** â†’ **"Deploy latest commit"**
2. Wait for build to complete (~3-5 minutes)
3. Once live, note your backend URL (e.g., `https://ai-loan-backend.onrender.com`)

### 1.4 Verify Backend
Visit: `https://your-backend-url.onrender.com/docs`
You should see the FastAPI Swagger UI.

---

## Step 2: Deploy Frontend on Vercel

### 2.1 Create New Project
1. Go to https://vercel.com/dashboard
2. Click **"Add New..."** â†’ **"Project"**
3. Import `sou-goog/Development-of-AI-Powered-Loan-Eligibility-Advisory-System`
4. Configure build settings:
   - **Framework Preset:** Create React App
   - **Root Directory:** `frontend`
   - **Build Command:** `npm run build`
   - **Output Directory:** `build`

### 2.2 Set Environment Variables
In Vercel project settings â†’ **Environment Variables**:
```
REACT_APP_API_URL=https://your-backend-url.onrender.com
```
(Replace with your actual Render backend URL from Step 1.3)

### 2.3 Deploy
1. Click **"Deploy"**
2. Wait for deployment (~2-3 minutes)
3. Vercel will provide your live URL (e.g., `https://ai-loan-system.vercel.app`)

### 2.4 Update Backend CORS
After frontend is deployed, update backend to allow your frontend domain:

1. In `backend/main.py`, find the CORS configuration (around line 90):
   ```python
   app.add_middleware(
       CORSMiddleware,
       allow_origins=["*"],  # Update this
       ...
   )
   ```

2. Replace `["*"]` with your actual frontend URL:
   ```python
   allow_origins=["https://ai-loan-system.vercel.app"],
   ```

3. Commit and push:
   ```bash
   git add backend/main.py
   git commit -m "Update CORS for production frontend"
   git push origin main
   ```

4. Render will auto-deploy the updated backend

---

## Step 3: Create Default Users

The backend auto-creates two default users on first startup:
- **Applicant:** `user@example.com` / `password123`
- **Manager:** `manager@example.com` / `manager123`

To verify, check Render logs for:
```
Created default applicant user
Created default manager user
```

---

## Step 4: Test the Deployment

### 4.1 Test Login
1. Visit your Vercel frontend URL
2. Login with `user@example.com` / `password123`
3. You should see the dashboard

### 4.2 Test Voice Agent
1. Click **"Voice Agent"** in the navigation
2. Allow microphone access
3. Click the microphone button
4. Say "Hello"
5. The agent should respond: "Hi! I'm LoanVoice. Could I get your full name to start?"

If voice works, your deployment is successful! ðŸš€

---

## Troubleshooting

### Issue: "Failed to connect to backend"
- **Fix:** Check `REACT_APP_API_URL` in Vercel is correct
- **Fix:** Verify backend is running on Render (check logs)

### Issue: "Voice agent not responding"
- **Fix:** Check Render logs for `GROQ_API_KEY` or `DEEPGRAM_API_KEY` errors
- **Fix:** Verify API keys are valid and have credits

### Issue: "Database connection error"
- **Fix:** Check `DATABASE_URL` in Render environment variables
- **Fix:** Verify PostgreSQL database is running

### Issue: "CORS error in browser console"
- **Fix:** Update `allow_origins` in `backend/main.py` with your frontend URL

---

## Monitoring

### Backend Logs (Render)
- Dashboard â†’ Your Service â†’ **Logs** tab
- Watch for errors related to API keys, database, or WebSocket connections

### Frontend Logs (Vercel)
- Dashboard â†’ Your Project â†’ **Deployments** â†’ Click deployment â†’ **Functions** tab
- Browser console (F12) for client-side errors

---

## Cost Breakdown (Free Tier)

| Service | Free Tier Limits |
|---------|-----------------|
| **Render** | 750 hours/month (sufficient for 24/7 uptime) |
| **Vercel** | 100 GB bandwidth, unlimited deployments |
| **PostgreSQL (Render)** | 256 MB storage, 97 connections |
| **Groq API** | Limited requests/month (check console.groq.com) |
| **Deepgram API** | $200 free credit (45 hours of audio) |

All services should work on free tier for development/demo purposes.

---

## Next Steps

1. **Custom Domain:** Add your domain in Vercel â†’ Settings â†’ Domains
2. **SSL:** Automatic on both Vercel and Render
3. **CI/CD:** Auto-deployment is already enabled (push to `main` â†’ auto-deploy)
4. **Scaling:** Upgrade Render plan for better performance if needed

---

## Support

If you encounter issues:
1. Check logs on Render and Vercel
2. Verify all environment variables are set correctly
3. Test API keys separately (use Postman or curl to hit Groq/Deepgram directly)

**Deployment Status Checklist:**
- [ ] Backend deployed on Render
- [ ] PostgreSQL database created
- [ ] Environment variables set (GROQ, DEEPGRAM)
- [ ] Frontend deployed on Vercel
- [ ] CORS updated with frontend URL
- [ ] Login works
- [ ] Voice agent responds

ðŸŽ‰ Once all boxes are checked, your AI Loan System is live!
